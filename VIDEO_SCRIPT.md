# ะกัะตะฝะฐัะธะน ะฒะธะดะตะพ-ะฟัะตะทะตะฝัะฐัะธะธ: ะกะตัะฒะธั ะะพะดะตัะฐัะธะธ ะะฑัะฐัะตะฝะธะน ะะปะธะตะฝัะพะฒ

## ๐น ะัะพะดะพะปะถะธัะตะปัะฝะพััั: 5-10 ะผะธะฝัั

---

## 1. ะะฐะบ ั ะฟะพะฝัะป ะทะฐะดะฐัั (1-2 ะผะธะฝััั)

### ะัะฐัะบะพะต ะธะทะปะพะถะตะฝะธะต:

> "ะะฐะดะฐัะฐ ัะพััะพัะปะฐ ะฒ ัะพะทะดะฐะฝะธะธ ัะธััะตะผั ะผะพะดะตัะฐัะธะธ ะพะฑัะฐัะตะฝะธะน ะบะปะธะตะฝัะพะฒ ะฝะฐ ะพัะฝะพะฒะต ัะพะฑััะธะนะฝะพะน ะฐััะธัะตะบัััั (Event-Driven Architecture). ะะตะพะฑัะพะดะธะผะพ ะฑัะปะพ ัะตะฐะปะธะทะพะฒะฐัั ะดะฒะฐ ะผะธะบัะพัะตัะฒะธัะฐ:
>  
> **Service-1 (Moderation)** โ ะฟะพััะตะฑะปัะตั ัะพะฑััะธั ะธะท Kafka Topic-1, ะฟัะธะผะตะฝัะตั ะฑะธะทะฝะตั-ะฟัะฐะฒะธะปะฐ ะผะพะดะตัะฐัะธะธ ะธ ะฟัะฑะปะธะบัะตั ะพะดะพะฑัะตะฝะฝัะต ัะพะฑััะธั ะฒ Topic-2.
>
> **Service-2 (Enrichment)** โ ะฟัะตะดะพััะฐะฒะปัะตั ะดะฐะฝะฝัะต ะพะฑะพะณะฐัะตะฝะธั ะพ ะบะปะธะตะฝัะฐั ัะตัะตะท REST API, ััะฐะฝััะธะตัั ะฒ Redis.
>
> ะะปััะตะฒัะต ััะตะฑะพะฒะฐะฝะธั:
> - ะะฑะตัะฟะตัะธัั ะธะดะตะผะฟะพัะตะฝัะฝะพััั ะพะฑัะฐะฑะพัะบะธ (ะดัะฑะปะธะบะฐัั ะฝะต ะดะพะปะถะฝั ะฟะพะฟะฐะดะฐัั ะฒ Topic-2)
> - ะะตะฐะปะธะทะพะฒะฐัั ะฝะตัะบะพะปัะบะพ ะฟัะฐะฒะธะป ะผะพะดะตัะฐัะธะธ (ะฟัะพะฒะตัะบะฐ ะดัะฑะปะธะบะฐัะพะฒ, ะฐะบัะธะฒะฝัั ะพะฑัะฐัะตะฝะธะน, ัะฐะฑะพัะตะณะพ ะฒัะตะผะตะฝะธ)
> - ะัะฟะพะปัะทะพะฒะฐัั ัะพะฒัะตะผะตะฝะฝัะต ะฟัะฐะบัะธะบะธ ัะฐะทัะฐะฑะพัะบะธ (SOLID, ะฟะฐััะตัะฝั ะฟัะพะตะบัะธัะพะฒะฐะฝะธั)
> - ะะฑะตัะฟะตัะธัั ะพัะบะฐะทะพัััะพะนัะธะฒะพััั ัะตัะตะท retry-ะผะตัะฐะฝะธะทะผั"

---

## 2. ะะฐะบะธะต ะฒะพะฟัะพัั ะฒะพะทะฝะธะบะปะธ ะธ ะบะฐะบ ัะตัะธะปะธ (1-2 ะผะธะฝััั)

### ะะพะฟัะพั 1: ะะฐะบ ะพะฑะตัะฟะตัะธัั ะธะดะตะผะฟะพัะตะฝัะฝะพััั?
**ะะตัะตะฝะธะต:** ะัะฟะพะปัะทะพะฒะฐะป MongoDB ะดะปั ััะฐะฝะตะฝะธั ะพะฑัะฐะฑะพัะฐะฝะฝัั ัะพะฑััะธะน. ะะตัะตะด ะพะฑัะฐะฑะพัะบะพะน ะบะฐะถะดะพะณะพ ัะพะฑััะธั ะฟัะพะฒะตััั ะฝะฐะปะธัะธะต `eventId` ะฒ ะฑะฐะทะต. ะัะปะธ ัะพะฑััะธะต ัะถะต ะตััั โ ะพัะบะปะพะฝัั ะบะฐะบ ะดัะฑะปะธะบะฐั.

```java
// DuplicateEventRule.java
@Override
public RuleResult apply(CustomerRequestEvent event, EnrichmentData enrichmentData) {
    if (processedEventRepository.existsByEventId(event.getEventId())) {
        return RuleResult.rejected(RULE_NAME, "Event already processed");
    }
    return RuleResult.passed(RULE_NAME);
}
```

### ะะพะฟัะพั 2: ะะฐะบ ัะดะตะปะฐัั ัะธััะตะผั ะฟัะฐะฒะธะป ัะฐััะธััะตะผะพะน?
**ะะตัะตะฝะธะต:** ะัะธะผะตะฝะธะป ะฟะฐััะตัะฝ **Chain of Responsibility** โ ะฒัะต ะฟัะฐะฒะธะปะฐ ัะตะฐะปะธะทััั ะธะฝัะตััะตะนั `ModerationRule`. ะะพะฒะพะต ะฟัะฐะฒะธะปะพ ะดะพะฑะฐะฒะปัะตััั ะบะฐะบ ะฝะพะฒัะน ะบะปะฐัั ะฑะตะท ะธะทะผะตะฝะตะฝะธั ัััะตััะฒัััะตะณะพ ะบะพะดะฐ (ะฟัะธะฝัะธะฟ OCP).

### ะะพะฟัะพั 3: ะงัะพ ะดะตะปะฐัั ะตัะปะธ Service-2 ะฝะตะดะพัััะฟะตะฝ?
**ะะตัะตะฝะธะต:** ะะตะฐะปะธะทะพะฒะฐะป **Retry-ะผะตัะฐะฝะธะทะผ** ั ัะบัะฟะพะฝะตะฝัะธะฐะปัะฝะพะน ะทะฐะดะตัะถะบะพะน (3 ะฟะพะฟััะบะธ, ะฝะฐัะฐะปัะฝะฐั ะทะฐะดะตัะถะบะฐ 1 ัะตะบัะฝะดะฐ, ะผะฝะพะถะธัะตะปั 2). ะัะธ ะฟะพะปะฝะพะผ ะพัะบะฐะทะต โ fallback ั ะฟััััะผะธ ะดะฐะฝะฝัะผะธ ะพะฑะพะณะฐัะตะฝะธั.

---

## 3. ะะฐะบะธะต ัะปะพะถะฝะพััะธ ะฒะพะทะฝะธะบะปะธ (1-2 ะผะธะฝััั)

### ะกะปะพะถะฝะพััั 1: ะะพะฝัะธะณััะฐัะธั Kafka ะฒ Docker
**ะัะพะฑะปะตะผะฐ:** Kafka ััะตะฑัะตั ะฟัะฐะฒะธะปัะฝะพะน ะฝะฐัััะพะนะบะธ listeners ะธ advertised.host ะดะปั ัะฐะฑะพัั ะฒะฝัััะธ ะธ ัะฝะฐััะถะธ Docker-ัะตัะธ.
**ะะตัะตะฝะธะต:** ะะฐัััะพะธะป ะดะฒะฐ listener'ะฐ โ ะพะดะธะฝ ะดะปั ะฒะฝัััะตะฝะฝะตะน ัะตัะธ Docker (`INSIDE://kafka:9093`), ะฒัะพัะพะน ะดะปั ะฒะฝะตัะฝะตะณะพ ะดะพัััะฟะฐ (`OUTSIDE://localhost:29092`).

### ะกะปะพะถะฝะพััั 2: ะกะตัะธะฐะปะธะทะฐัะธั/ะดะตัะตัะธะฐะปะธะทะฐัะธั ัะพะฑััะธะน
**ะัะพะฑะปะตะผะฐ:** Kafka ะฟะตัะตะดะฐัั ะดะฐะฝะฝัะต ะฒ ัะพัะผะฐัะต JSON, ะฝัะถะฝะพ ะฑัะปะพ ะพะฑะตัะฟะตัะธัั ะบะพััะตะบัะฝะพะต ะฟัะตะพะฑัะฐะทะพะฒะฐะฝะธะต.
**ะะตัะตะฝะธะต:** ะัะฟะพะปัะทะพะฒะฐะป `JsonSerializer` ะธ `JsonDeserializer` ะธะท Spring Kafka ั ัะฒะฝัะผ ัะบะฐะทะฐะฝะธะตะผ trusted packages.

### ะกะปะพะถะฝะพััั 3: ะกะธะฝััะพะฝะธะทะฐัะธั ัะฐะฑะพัั ะดะฒัั ัะตัะฒะธัะพะฒ
**ะัะพะฑะปะตะผะฐ:** Service-1 ะดะพะปะถะตะฝ ะดะพะถะดะฐัััั ะพัะฒะตัะฐ ะพั Service-2.
**ะะตัะตะฝะธะต:** ะัะฟะพะปัะทะพะฒะฐะป ัะตะฐะบัะธะฒะฝัะน `WebClient` ั ะฑะปะพะบะธััััะธะผ `.block()` ะดะปั ะณะฐัะฐะฝัะธะธ ะฟะพะปััะตะฝะธั ะดะฐะฝะฝัั ะฟะตัะตะด ะฟัะธะผะตะฝะตะฝะธะตะผ ะฟัะฐะฒะธะป.

---

## 4. ะะปััะตะฒัะต ะผะพะผะตะฝัั ัะตัะตะฝะธั (ะฒ ะฟะพััะดะบะต ัะฑัะฒะฐะฝะธั ะฒะฐะถะฝะพััะธ) (2-3 ะผะธะฝััั)

### ๐ฅ 1. ะกะพะฑััะธะนะฝะฐั ะฐััะธัะตะบัััะฐ ั Kafka
- Consumer ะฟะพะปััะฐะตั ัะพะฑััะธั ะธะท Topic-1
- ะะพัะปะต ะพะฑัะฐะฑะพัะบะธ ะพะดะพะฑัะตะฝะฝัะต ัะพะฑััะธั ะฟัะฑะปะธะบััััั ะฒ Topic-2
- ะะฑะตัะฟะตัะตะฝะฐ ะฝะฐะดัะถะฝะฐั ะดะพััะฐะฒะบะฐ ัะตัะตะท manual acknowledge

### ๐ฅ 2. ะะฒะธะถะพะบ ะฟัะฐะฒะธะป ะผะพะดะตัะฐัะธะธ (ModerationRulesEngine)
- ะะฐััะตัะฝ **Chain of Responsibility**
- ะัะฐะฒะธะปะฐ ะฒัะฟะพะปะฝััััั ะฟะพ ะฟัะธะพัะธัะตัั
- ะััะฐะฝะพะฒะบะฐ ะฟัะธ ะฟะตัะฒะพะผ ะพัะบะปะพะฝะตะฝะธะธ
- ะะตะณะบะพ ะดะพะฑะฐะฒะปััั ะฝะพะฒัะต ะฟัะฐะฒะธะปะฐ

**ะะตะฐะปะธะทะพะฒะฐะฝะฝัะต ะฟัะฐะฒะธะปะฐ:**
| ะัะธะพัะธัะตั | ะัะฐะฒะธะปะพ | ะะฟะธัะฐะฝะธะต |
|-----------|---------|----------|
| 1 | DuplicateEventRule | ะะดะตะผะฟะพัะตะฝัะฝะพััั ัะตัะตะท MongoDB |
| 2 | ActiveRequestRule | ะัะพะฒะตัะบะฐ ะฐะบัะธะฒะฝัั ะพะฑัะฐัะตะฝะธะน ะฒ ะบะฐัะตะณะพัะธะธ |
| 3 | WorkingHoursRule | ะัะพะฒะตัะบะฐ ัะฐะฑะพัะตะณะพ ะฒัะตะผะตะฝะธ (09:00-18:00) |

### ๐ฅ 3. ะะฝัะตะณัะฐัะธั ะผะตะถะดั ัะตัะฒะธัะฐะผะธ
- REST API ะดะปั ะฟะพะปััะตะฝะธั ะดะฐะฝะฝัั ะพะฑะพะณะฐัะตะฝะธั
- WebClient ั retry ะธ timeout
- Fallback ะฟัะธ ะฝะตะดะพัััะฟะฝะพััะธ ัะตัะฒะธัะฐ

### 4. ะกะพะฑะปัะดะตะฝะธะต ะฟัะธะฝัะธะฟะพะฒ SOLID
- **SRP**: ะะฐะถะดัะน ะบะปะฐัั โ ะพะดะฝะฐ ะพัะฒะตัััะฒะตะฝะฝะพััั
- **OCP**: ะัะฐะฒะธะปะฐ ะดะพะฑะฐะฒะปััััั ะฑะตะท ะธะทะผะตะฝะตะฝะธั ะบะพะดะฐ
- **LSP**: ะัะต ะฟัะฐะฒะธะปะฐ ะฒะทะฐะธะผะพะทะฐะผะตะฝัะตะผั
- **DIP**: ะะฐะฒะธัะธะผะพััั ะพั ะธะฝัะตััะตะนัะพะฒ

### 5. ะัะฟะพะปัะทะพะฒะฐะฝะธะต ัะพะฒัะตะผะตะฝะฝะพะณะพ ััะตะบะฐ
- Java 17 (switch expressions, records, var)
- Spring Boot 3.2.5
- Docker Compose ะดะปั ะปะพะบะฐะปัะฝะพะน ัะฐะทัะฐะฑะพัะบะธ
- Swagger UI ะดะปั ะดะพะบัะผะตะฝัะฐัะธะธ API

---

## 5. ะะทะผะตะฝะธะปะพัั ะฑั ัะตัะตะฝะธะต ะฟัะธ ะฑะพะปััะตะผ ะฒัะตะผะตะฝะธ? (1 ะผะธะฝััะฐ)

### ะงัะพ ะฑั ะดะพะฑะฐะฒะธะป/ัะปัััะธะป:

1. **Dead Letter Queue (DLQ)** โ ะดะปั ัะพะฑััะธะน, ะบะพัะพััะต ะฝะต ัะดะฐะปะพัั ะพะฑัะฐะฑะพัะฐัั ะฟะพัะปะต ะฒัะตั retry
   
2. **Circuit Breaker** (ะฝะฐะฟัะธะผะตั, Resilience4j) โ ะดะปั ะฑััััะพะณะพ ะพัะบะฐะทะฐ ะฟัะธ ะฟัะพะฑะปะตะผะฐั ั Service-2

3. **ะะตััะธะบะธ ะธ ััะตะนัะธะฝะณ** โ Micrometer + Prometheus + Jaeger ะดะปั ะฟะพะปะฝะพะน observability

4. **ะััะธัะพะฒะฐะฝะธะต ะดะฐะฝะฝัั ะพะฑะพะณะฐัะตะฝะธั** โ ะฝะฐ ััะพัะพะฝะต Service-1 ััะพะฑั ัะฝะธะทะธัั ะฝะฐะณััะทะบั ะฝะฐ Service-2

5. **ะัะธะฝััะพะฝะฝะฐั ะพะฑัะฐะฑะพัะบะฐ** โ ะฟะพะปะฝะพัััั ะฝะตะฑะปะพะบะธััััะฐั ะพะฑัะฐะฑะพัะบะฐ ัะตัะตะท Project Reactor

6. **ะะพะปััะต unit ะธ integration ัะตััะพะฒ** โ ะฟะพะบัััะธะต edge cases

7. **Rate Limiting** โ ะพะณัะฐะฝะธัะตะฝะธะต ะบะพะปะธัะตััะฒะฐ ะทะฐะฟัะพัะพะฒ ะพั ะบะปะธะตะฝัะพะฒ

---

## 6. ะะตะผะพะฝัััะฐัะธั ัะฐะฑะพัั ะบะพะดะฐ (2-3 ะผะธะฝััั)

### ะะพะบะฐะทะฐัั ะฝะฐ ัะบัะฐะฝะต:

#### ะจะฐะณ 1: ะะฐะฟััะตะฝะฝัะต ะบะพะฝัะตะนะฝะตัั
```powershell
docker ps
```
*ะะพะบะฐะทะฐัั ััะพ ะฒัะต 7 ะบะพะฝัะตะนะฝะตัะพะฒ ะทะฐะฟััะตะฝั: service-1, service-2, kafka, zookeeper, mongodb, redis, kafka-ui*

#### ะจะฐะณ 2: Swagger UI Service-1
1. ะัะบัััั http://localhost:8080/swagger-ui.html
2. ะะพะบะฐะทะฐัั ะดะพัััะฟะฝัะต endpoints

#### ะจะฐะณ 3: ะกะพะทะดะฐะฝะธะต ัะตััะพะฒัั ะดะฐะฝะฝัั
1. ะัะบัััั http://localhost:8081/swagger-ui.html (Service-2)
2. ะัะทะฒะฐัั `POST /api/v1/enrichment/setup-test-data`
3. ะะพะบะฐะทะฐัั ัะพะทะดะฐะฝะฝัั ะบะปะธะตะฝัะพะฒ ะฒ Redis Commander (http://localhost:8092)

#### ะจะฐะณ 4: ะฃัะฟะตัะฝะฐั ะผะพะดะตัะฐัะธั
```json
{
  "eventId": "EVT-DEMO-001",
  "customerId": "CUST-001",
  "requestId": "REQ-001",
  "category": "TECHNICAL_SUPPORT",
  "subject": "ะะตะผะพ ะพะฑัะฐัะตะฝะธะต",
  "description": "ะขะตััะพะฒะพะต ะพะฑัะฐัะตะฝะธะต ะดะปั ะฟัะตะทะตะฝัะฐัะธะธ",
  "priority": "HIGH",
  "timestamp": "2026-02-07T10:00:00"
}
```
**ะะตะทัะปััะฐั:** `status: "PUBLISHED"` โ ัะพะฑััะธะต ะฟัะพัะปะพ ะฒัะต ะฟัะฐะฒะธะปะฐ

#### ะจะฐะณ 5: ะัะพะฒะตัะบะฐ ะธะดะตะผะฟะพัะตะฝัะฝะพััะธ
ะะพะฒัะพัะธัั ัะพั ะถะต ะทะฐะฟัะพั โ `status: "REJECTED"` โ ะดัะฑะปะธะบะฐั ะฝะต ะฟัะพะฟััะตะฝ

#### ะจะฐะณ 6: ะะพะบะฐะทะฐัะตะปะธ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ
1. ะัะบัััั ะปะพะณะธ: `docker-compose logs -f service-1`
2. ะะพะบะฐะทะฐัั ะฒัะตะผั ะพะฑัะฐะฑะพัะบะธ ัะพะฑััะธะน
3. ะะพะบะฐะทะฐัั ะฒ Kafka UI ัะพะพะฑัะตะฝะธั ะฒ ัะพะฟะธะบะฐั

#### ะจะฐะณ 7: ะกัะฐัะธััะธะบะฐ
ะัะทะฒะฐัั `GET /api/v1/moderation/statistics` โ ะฟะพะบะฐะทะฐัั ัะบะพะปัะบะพ ัะพะฑััะธะน ะพะฑัะฐะฑะพัะฐะฝะพ

---

## 7. ะะฐะบะปััะตะฝะธะต (30 ัะตะบัะฝะด)

> "ะ ัะตะทัะปััะฐัะต ัะพะทะดะฐะฝะฐ ะผะธะบัะพัะตัะฒะธัะฝะฐั ัะธััะตะผะฐ ะผะพะดะตัะฐัะธะธ ะพะฑัะฐัะตะฝะธะน ะบะปะธะตะฝัะพะฒ ั:
> - ะกะพะฑััะธะนะฝะพะน ะฐััะธัะตะบัััะพะน ะฝะฐ Apache Kafka
> - ะะธะฑะบะธะผ ะดะฒะธะถะบะพะผ ะฟัะฐะฒะธะป ะผะพะดะตัะฐัะธะธ
> - ะะฐัะฐะฝัะธัะพะฒะฐะฝะฝะพะน ะธะดะตะผะฟะพัะตะฝัะฝะพัััั
> - ะัะบะฐะทะพัััะพะนัะธะฒะพะน ะธะฝัะตะณัะฐัะธะตะน ะผะตะถะดั ัะตัะฒะธัะฐะผะธ
> - ะะพะปะฝะพะน ะดะพะบัะผะตะฝัะฐัะธะตะน ัะตัะตะท Swagger
> 
> ะะพะด ัะพะพัะฒะตัััะฒัะตั ะฟัะธะฝัะธะฟะฐะผ SOLID ะธ ะธัะฟะพะปัะทัะตั ัะพะฒัะตะผะตะฝะฝัะต ะฟัะฐะบัะธะบะธ Java-ัะฐะทัะฐะฑะพัะบะธ."

---

## ๐ ะงะตะบ-ะปะธัั ะฟะตัะตะด ะทะฐะฟะธััั ะฒะธะดะตะพ

- [ ] Docker Desktop ะทะฐะฟััะตะฝ
- [ ] ะัะต ะบะพะฝัะตะนะฝะตัั ัะฐะฑะพัะฐัั (`docker-compose up`)
- [ ] Swagger UI ะพัะบััะฒะฐะตััั ะฝะฐ ะพะฑะพะธั ัะตัะฒะธัะฐั
- [ ] ะขะตััะพะฒัะต ะดะฐะฝะฝัะต ัะพะทะดะฐะฝั
- [ ] ะะฐะผะตัะฐ ะฒะบะปััะตะฝะฐ
- [ ] ะกะบัะธะฝ ัะบัะฐะฝะฐ ะฝะฐัััะพะตะฝ
- [ ] ะะธะบัะพัะพะฝ ะฟัะพะฒะตัะตะฝ

---

## ๐ฅ ะกัััะบัััะฐ ัะบัะฐะฝะฐ ะฒะพ ะฒัะตะผั ะทะฐะฟะธัะธ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ะัะฝะพะฒะฝะพะน ะบะพะฝัะตะฝั (IDE / ะัะฐัะทะตั)       โ
โ                                         โ
โ                                         โ
โ                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโค
โ ะขะตัะผะธะฝะฐะป / ะะพะณะธ        โ  ะะตะฑ-ะบะฐะผะตัะฐ    โ
โ                        โ    (PIP)       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโ
```
